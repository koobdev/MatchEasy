<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:include="/include/head.html">
    <title>TITLE</title>
</head>
<body>
<div th:include="/include/header.html"></div>

<div data-uk-height-viewport="expand: true">
    <div class="uk-container uk-container-expand">
        <div class="uk-card uk-card-default uk-card-style">
            <div class="uk-card-body">
                <div class="uk-overflow-auto">
                    <div class="uk-text-right uk-margin-small uk-margin-right">
                        <button class="uk-button uk-button-primary" uk-toggle="target: #registerForm">게시글 작성</button>
                    </div><br/><br/><br/>

                    <div class="uk-grid uk-child-width-1-2@s uk-child-width-1-3@m uk-child-width-1-4@l uk-child-width-1-5@xl uk-grid-match uk-sortable">
                        <div class="uk-card uk-card-hover uk-card-default">
                            <div class="uk-card-header">
                                <div class="uk-grid uk-grid-small" data-uk-grid>
                                    <div class="uk-width-expand">
                                        <p class="uk-text-small" id="title" >프로젝트 팀원 모집합니다.(test)</p>
                                    </div>
                                    <div class="uk-width-auto uk-text-right">
                                        <button class="uk-button uk-button-small">모집중</button>
                                    </div>
                                </div>
                            </div>
                            <div class="uk-card-body">
                                <p id="content">웹 개발자 스터디 함께 하실분을 모집합니다.</p>
                                <p class="uk-text-small" id="date">2022-03-01 ~ 2022-03-31</p>
                            </div>
                            <div class="uk-card-footer">
                                <div class="uk-width-auto">
                                    <img th:src="@{/static/image/java.png}">
                                    <img th:src="@{/static/image/spring.png}">
                                    <img th:src="@{/static/image/react.png}">
                                </div>
                            </div>
                        </div>

                        <div class="uk-card uk-card-hover uk-card-default" >
                            <div class="uk-card-header">
                                <div class="uk-grid uk-grid-small" data-uk-grid>
                                    <div class="uk-width-expand">
                                        <p class="uk-text-small">프로젝트 팀원 모집합니다.(test)</p>
                                    </div>
                                    <div class="uk-width-auto uk-text-right">
                                        <button class="uk-button uk-button-danger uk-button-small">모집완료</button>
                                    </div>
                                </div>
                            </div>
                            <div class="uk-card-body">
                                <p>스터디 함께 하실분!!!!!</p>
                                <p class="uk-text-small">2022-02-01 ~ 2022-02-28</p>
                            </div>
                            <div class="uk-card-footer">
                                <div class="uk-width-auto">
                                    <img th:src="@{/static/image/java.png}">
                                    <img th:src="@{/static/image/spring.png}">
                                    <img th:src="@{/static/image/react.png}">
                                </div>
                            </div>
                        </div>

                        <div>
                            추가
                        </div>
                    </div>


                    <div id="registerForm" class="uk-modal-container" uk-modal>
                        <div class="uk-modal-dialog">
                            <button class="uk-modal-close-default" type="button" uk-close></button>
                            <div class="uk-modal-header uk-margin-small">
                                <p class="uk-modal-title">게시글 작성하기</p>
                            </div>
                            <div class="uk-modal-body">

                                <div class="uk-text-right uk-margin-medium-top" id="btnRegister">
                                    <button class="uk-button uk-button-primary uk-button-radius"
                                            onClick="registerVouching()">등록
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>

<script>

    let accessToken = storage.get("accessToken");
    let url = "http://localhost:8080/board/list";
    let xhr = new XMLHttpRequest();
    xhr.open('GET', url);
    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
    xhr.setRequestHeader('Authorization', 'Bearer ' + accessToken);
    xhr.responseType = 'json';
    xhr.send();

    xhr.onreadystatechange = function () {
        if(xhr.readyState == 4 && xhr.status == 200) {
            let data = xhr.response;
            console.log(data);
            let boardTable = document.getElementById("boardTable");
            let append = "";
            for(i in data){
                append = "<tr onclick='openDetail(" + data[i].id + ")'>";
                append += "<td>" + data[i].title + "</td>";
                append += "<td>" + data[i].writerId + "</td>";
                append += "<td>" + data[i].content + "</td>";
                append += "<td>" + data[i].regdate + "</td>";
                append += "</tr>";
            }
            boardTable.innerHTML = append;
        }
    };

    function openDetail(id) {
        storage.set("contentDetail", id);
        window.location.href = "/form/chatRoom";
    }
</script>